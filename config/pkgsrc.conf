# Build configuration which will not affect generated binaries

ALLOW_VULNERABLE_PACKAGES=yes
CFLAGS+=-pipe
CREATE_WRKDIR_SYMLINK=yes
PKGSRCDIR?=/pkgsrc
# PKGSRC_SETENV=env -i
SU_CMD=sudo sh -c
WRKOBJDIR?=/var/obj/pkg

. if ${MACHINE} != vax
PKG_DEVELOPER?=yes
PKG_COMPRESSION=xz
PKGSRC_LOCKTYPE=sleep
. endif

.if !defined(STANDARD_BINARIES)

  USE_CPUFLAGS=yes
. if ${MACHINE} == i386
    CPU_DIR=
    CPU_FLAGS=-march=pentium-m
. elif ${MACHINE} == amd64
    CPU_DIR=
. endif # ${MACHINE} == i386

  ACCEPTABLE_LICENSES+= adobe-flashsupport-license
  ACCEPTABLE_LICENSES+= erlang-public-license
  ACCEPTABLE_LICENSES+= esdl-license
  ACCEPTABLE_LICENSES+= flash-license
  ACCEPTABLE_LICENSES+= gnu-gpl-v2.1 # p7zip
  ACCEPTABLE_LICENSES+= lame-license
  ACCEPTABLE_LICENSES+= libdvdcss-license
  ACCEPTABLE_LICENSES+= mozilla-trademark-license
  ACCEPTABLE_LICENSES+= ms-ttf-license
  ACCEPTABLE_LICENSES+= opera-1200-license
  ACCEPTABLE_LICENSES+= oracle-binary-code-license
  ACCEPTABLE_LICENSES+= unrar-license # p7zip
  ACCEPTABLE_LICENSES+= vera-ttf-license
  ACCEPTABLE_LICENSES+= yed-license

  # Default versions
  JPEG_DEFAULT=libjpeg-turbo
  MYSQL_VERSION_DEFAULT=57
  PGSQL_VERSION_DEFAULT=10
  PHP_VERSION_DEFAULT=71
  PKG_APACHE_DEFAULT=apache24
  PYTHON_VERSION_DEFAULT=37

  PKG_JVM_DEFAULT=openjdk8
  APACHE_MODULES+=logio
  LIBDVDCSS_MASTER_SITES=http://download.videolan.org/pub/videolan/libdvdcss/
  MAJORDOMO_HOMEDIR=/var/majordomo
  PAPERSIZE=A4
  # PERL5_SITEBIN=/usr/local/bin
  # PERL5_SITEPREFIX=/usr/local/lib/perl5/site_perl
  PKG_DEFAULT_OPTIONS=sun-jre-jce faac -kerberos -gcc-java -pulseaudio -polkit
  PKG_OPTIONS.adobe-flash-plugin=nspluginwrapper
  PKG_OPTIONS.doxygen=-latex
  PKG_OPTIONS.exim=exim-auth-dovecot exim-lookup-mysql

# Avoid error with xulrunner* (for icedteaweb)
  FIREFOX_BRANDING=www/firefox
. if !empty(FIREFOX_BRANDING:M${PKGPATH})
    PKG_OPTIONS.firefox=official-mozilla-branding # -pulseaudio
. endif

  PKG_OPTIONS.nginx=dav
  PKG_OPTIONS.openttd=ttd-data
  PKG_OPTIONS.p5-HTML-Mason=-modperl
  PKG_OPTIONS.pari=-doc
  PKG_OPTIONS.midori=gtk3
  PKG_OPTIONS.roundcube=pgsql nginx
  PKG_OPTIONS.thunderbird=official-mozilla-branding
  PKG_RCD_SCRIPTS=yes

. if ${MACHINE} == vax
    PKG_OPTIONS.SDL=-arts -esound -nas -pulseaudio
. endif

  PKG_USE_ETC=\
    databases/mysql57-client \
    databases/mysql57-server \
    lang/pear \
    lang/php71 \
    lang/php72 \
    mail/dovecot2 \
    mail/exim \
    mail/re-alpine \
    mail/roundcube \
    mail/spamassassin \
    net/dante \
    net/dhcpcd \
    net/dnsmasq \
    net/inadyn \
    net/openvpn \
    net/samba \
    net/samba4 \
    net/vsftpd \
    security/msu \
    security/msudir \
    security/nessus \
    security/nessus-core \
    security/nessus-libraries \
    security/nessus-plugins \
    security/py-certbot \
    security/sudo \
    shells/zsh \
    sysutils/dirvish \
    sysutils/backuppc \
    sysutils/munin-node \
    sysutils/munin-server \
    sysutils/ups-nut \
    sysutils/xentools48 \
    www/ap-php \
    www/apache24 \
    www/nginx \
    www/squid \
    www/thttpd \
    www/tinyproxy \
    x11/xdm

. if !empty(PKG_USE_ETC:M${PKGPATH})
    PKG_SYSCONFBASE?=/etc
. endif

#textproc/icu fails to build with gcc 6.4
  BOOTSTRAP_PKGDIRS=\
    devel/cpuflag \
    sysutils/checkperms \
    pkgtools/cwrappers \
    pkgtools/digest \
    sysutils/xentools48 \
    lang/gcc6 \
    \
    devel/boost-libs \
    multimedia/mkvtoolnix \
    fonts/harfbuzz \
    net/grive2 \
    textproc/icu

. if empty(BOOTSTRAP_PKGDIRS:M${PKGPATH})
    GCC_REQD+=6.1
. endif

.endif 	# STANDARD_BINARIES

.if exists(/mono/adm)
  PKGCHK_CONF?=${PKGSRCDIR}/local/config/pkgchk.mono
.else
  PKGCHK_CONF?=${PKGSRCDIR}/local/config/pkgchk.conf
.endif

# LINTPKGSRC definition should come after normal to workaround lintpkgsrc issue
.ifndef LINTPKGSRC
  OS_VERSION_=${OS_VERSION:C/_.*//}
  PACKAGES=${PKGSRCDIR}/packages/${OPSYS}-${OS_VERSION_}-${MACHINE_ARCH}${CPU_DIR}
.else
  PACKAGES=${PKGSRCDIR}/packages
.endif

  PKG_OPTIONS.nmap=lua
